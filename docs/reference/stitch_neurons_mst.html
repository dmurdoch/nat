<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Stitch multiple fragments into single neuron using minimum spanning tree — stitch_neurons_mst • nat</title>

<!-- favicons -->
<link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png" />
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png" />
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png" />
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png" />

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Stitch multiple fragments into single neuron using minimum spanning tree — stitch_neurons_mst" />
<meta property="og:description" content="Stitch multiple fragments into single neuron using minimum spanning tree" />
<meta property="og:image" content="/logo.svg" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">nat</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.10.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/neurons-intro.html">Introduction to neurons and neuronlists</a>
    </li>
    <li>
      <a href="../articles/neurons-as-graph.html">Working with individual neurons as graph structures</a>
    </li>
    <li>
      <a href="../articles/plotly.html">3D graphics</a>
    </li>
    <li>
      <a href="../articles/NeuroGeometry.html">NeuroGeometry: Analysing 3D morphology of neurons</a>
    </li>
  </ul>
</li>
<li>
  <a href="../articles/Installation.html">Installation</a>
</li>
<li>
  <a href="../index.html#learn">Learn</a>
</li>
<li>
  <a href="../index.html#help">Help</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://natverse.github.io">natverse</a>
</li>
<li>
  <a href="https://github.com/natverse/nat">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Stitch multiple fragments into single neuron using minimum spanning tree</h1>
    <small class="dont-index">Source: <a href='https://github.com/natverse/nat/blob/master/R/neuron.R'><code>R/neuron.R</code></a></small>
    <div class="hidden name"><code>stitch_neurons_mst.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Stitch multiple fragments into single neuron using minimum spanning tree</p>
    </div>

    <pre class="usage"><span class='fu'>stitch_neurons_mst</span><span class='op'>(</span><span class='va'>x</span>, threshold <span class='op'>=</span> <span class='cn'>Inf</span>, k <span class='op'>=</span> <span class='fl'>10L</span><span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>x</th>
      <td><p>Fragments that could be a <code><a href='neuronlist.html'>neuronlist</a></code> containing
multiple neurons or a single neuron with multiple unconnected subtrees.</p></td>
    </tr>
    <tr>
      <th>threshold</th>
      <td><p>The threshold distance above which new vertices will not be
connected (default=<code>Inf</code> disables this feature). This parameter
prevents the merging of vertices that are so far away from the main neuron
that they are likely to be spurious.</p></td>
    </tr>
    <tr>
      <th>k</th>
      <td><p>The number of nearest neighbours to consider when trying to merge
different clusters.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A single <code>neuron</code> object containing all input fragments.</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>The neurons are joined using the minimum spanning tree i.e. the tree
  that minimises the sum of edge weights (here, the Euclidean distance). The
  neuron is rooted in the largest cluster; if this cluster contained the
  original root of the neuron, then this should be retained.</p>
<p>Note that when a threshold length is used, it must be specified in the same
  units (microns, nm etc) as the neuron being stitched.</p>
<p>If you wish to process a neuronlist containing multiple neurons each of
  which must have all their subtrees stitched then you must use
  <code><a href='nlapply.html'>nlapply</a></code> to process the list iteratively.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='simplify_neuron.html'>simplify_neuron</a></code>, <code><a href='spine.html'>spine</a></code>,
  <code><a href='ngraph.html'>ngraph</a></code>, <code>igraph::<a href='https://rdrr.io/pkg/igraph/man/mst.html'>mst</a></code></p></div>
    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>Sridhar Jagannathan <a href='mailto:j.sridharrajan@gmail.com'>j.sridharrajan@gmail.com</a></p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='va'>n</span><span class='op'>=</span><span class='va'>Cell07PNs</span><span class='op'>[[</span><span class='st'>'ECA34L'</span><span class='op'>]</span><span class='op'>]</span>
<span class='co'># find the tree with the 10 most important branches</span>
<span class='va'>n_main</span><span class='op'>=</span><span class='fu'><a href='simplify_neuron.html'>simplify_neuron</a></span><span class='op'>(</span><span class='va'>n</span>, n <span class='op'>=</span> <span class='fl'>10</span><span class='op'>)</span>
<span class='co'># and the complement</span>
<span class='va'>n_branches</span><span class='op'>=</span><span class='fu'><a href='simplify_neuron.html'>simplify_neuron</a></span><span class='op'>(</span><span class='va'>n</span>, n <span class='op'>=</span> <span class='fl'>10</span>, invert <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>

<span class='co'># plot the inputs</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>n_main</span>, col<span class='op'>=</span><span class='st'>'red'</span>, WithNodes<span class='op'>=</span><span class='cn'>FALSE</span><span class='op'>)</span>
</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>n_branches</span>, col<span class='op'>=</span><span class='st'>'blue'</span>, add<span class='op'>=</span><span class='cn'>TRUE</span>, WithNodes<span class='op'>=</span><span class='cn'>FALSE</span><span class='op'>)</span>
</div><div class='img'><img src='stitch_neurons_mst-1.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'># join the two fragments back together again</span>
<span class='co'># first make a neuronlist containing the two fragments</span>
<span class='va'>nl</span><span class='op'>=</span><span class='fu'><a href='neuronlist.html'>neuronlist</a></span><span class='op'>(</span><span class='va'>n_main</span>, <span class='va'>n_branches</span><span class='op'>)</span>
<span class='co'># and stitch those</span>
<span class='va'>n_stitched</span><span class='op'>=</span><span class='fu'>stitch_neurons_mst</span><span class='op'>(</span><span class='va'>nl</span><span class='op'>)</span>

<span class='kw'>if</span> <span class='op'>(</span><span class='cn'>FALSE</span><span class='op'>)</span> <span class='op'>{</span>
<span class='co'># look at the neurons in 3D - they appear identical in this case</span>
<span class='fu'><a href='plot3d.html'>plot3d</a></span><span class='op'>(</span><span class='va'>n</span>, alpha<span class='op'>=</span><span class='fl'>.5</span>, col<span class='op'>=</span><span class='st'>'cyan'</span>, WithNodes<span class='op'>=</span><span class='cn'>FALSE</span><span class='op'>)</span>
<span class='fu'><a href='plot3d.html'>plot3d</a></span><span class='op'>(</span><span class='va'>n_stitched</span>, alpha<span class='op'>=</span><span class='fl'>.5</span>, col<span class='op'>=</span><span class='st'>'red'</span>, WithNodes<span class='op'>=</span><span class='cn'>FALSE</span><span class='op'>)</span>
<span class='op'>}</span>

<span class='co'>## second example neuron containing multiple sub trees</span>
<span class='va'>n</span><span class='op'>=</span><span class='va'>Cell07PNs</span><span class='op'>[[</span><span class='st'>'ECA34L'</span><span class='op'>]</span><span class='op'>]</span>
<span class='co'># remove a single vertex, breaking the neuron in two</span>
<span class='co'># note that the root (purple node) has moved </span>
<span class='va'>np</span><span class='op'>=</span><span class='fu'><a href='prune_vertices.html'>prune_vertices</a></span><span class='op'>(</span><span class='va'>n</span>, <span class='fl'>105</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>np</span><span class='op'>)</span>
</div><div class='img'><img src='stitch_neurons_mst-2.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'># now stitch the broken neuron back together again</span>
<span class='va'>nph</span><span class='op'>=</span><span class='fu'>stitch_neurons_mst</span><span class='op'>(</span><span class='va'>np</span><span class='op'>)</span>
<span class='co'># note that the root remains the same as the input neuron (np)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>nph</span><span class='op'>)</span>
</div><div class='img'><img src='stitch_neurons_mst-3.png' alt='' width='700' height='433' /></div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Gregory Jefferis, James Manton, Sridhar Jagannathan.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


